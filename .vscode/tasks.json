{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "kill-servers",
            "type": "shell",
            // Use cmd /c for taskkill as it's sometimes more reliable across systems
            // Alternatively, use powershell directly if preferred:
            // "command": "taskkill /F /IM python.exe /T ; taskkill /F /IM node.exe /T",
            "windows": { // Specify windows-specific command
                "command": "cmd",
                "args": [
                    "/c", // Run Command and then terminate cmd window
                    "taskkill /F /IM python.exe /T & taskkill /F /IM node.exe /T" // Use & to chain commands in cmd
                ]
            },
            "linux": { // Add linux/mac equivalents if needed
                "command": "pkill -f python.exe ; pkill -f node" // Example, adjust as needed
            },
            "osx": {
                 "command": "pkill -f python.exe ; pkill -f node" // Example, adjust as needed
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "never", // Don't show terminal for this kill task
                "panel": "shared",
                "showReuseMessage": false,
                "clear": false
            }
        },
        {
            "label": "start-backend",
            "type": "shell",
            "command": "python", // Command
            "args": ["backend_server_async.py"], // Arguments
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new", // Open in a new terminal panel
                "group": "servers" // Group terminals together (optional)
            },
            "runOptions": { "runOn": "folderOpen" } // Optional: Run when folder opens
        },
        {
            "label": "start-frontend",
            "type": "shell",
            "command": "npm", // Command
            "args": ["run", "dev"], // Arguments
            "options": {
                "cwd": "${workspaceFolder}/superego-frontend" // Set working directory
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "new", // Open in a new terminal panel
                "group": "servers" // Group terminals together (optional)
            },
             "runOptions": { "runOn": "folderOpen" } // Optional: Run when folder opens
        },
        {
            "label": "Start Dev Environment",
            "dependsOn": [
                "kill-servers", // Run kill task first
                "start-backend",
                "start-frontend"
            ],
            "dependsOrder": "sequence", // Run kill first, then others can start
            // If you want backend/frontend to start truly in parallel after kill:
            // "dependsOrder": "parallel", // But ensure kill-servers is listed first if sequence matters for kill
            "problemMatcher": [],
             "group": {
                "kind": "build", // Make this a default build task (Ctrl+Shift+B)
                "isDefault": true
            }
        }
    ]
}